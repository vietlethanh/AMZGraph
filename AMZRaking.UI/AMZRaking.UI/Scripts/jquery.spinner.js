!function(i){"use strict";var n,t=function(n,s){return s=i.extend({},s),this.$el=n,this.options=i.extend({},t.rules.defaults,t.rules[s.rule]||{},s),this.min=parseFloat(this.options.min)||0,this.max=parseFloat(this.options.max)||0,this.$el.on("focus.spinner",i.proxy(function(n){n.preventDefault(),i(document).trigger("mouseup.spinner"),this.oldValue=this.value()},this)).on("change.spinner",i.proxy(function(i){i.preventDefault(),this.value(this.$el.val())},this)).on("keydown.spinner",i.proxy(function(i){var n={38:"up",40:"down"}[i.which];n&&(i.preventDefault(),this.spin(n))},this)),this.oldValue=this.value(),this.value(this.$el.val()),this};t.rules={defaults:{min:null,max:null,step:1,precision:0},currency:{min:0,max:null,step:.01,precision:2},quantity:{min:1,max:999,step:1,precision:0},percent:{min:1,max:100,step:1,precision:0},month:{min:1,max:12,step:1,precision:0},day:{min:1,max:31,step:1,precision:0},hour:{min:0,max:23,step:1,precision:0},minute:{min:1,max:59,step:1,precision:0},second:{min:1,max:59,step:1,precision:0}},t.prototype={spin:function(n){if("disabled"!==this.$el.attr("disabled")){this.oldValue=this.value();var t=i.isFunction(this.options.step)?this.options.step.call(this,n):this.options.step;switch(n){case"up":this.value(this.oldValue+Number(t,10));break;case"down":this.value(this.oldValue-Number(t,10))}}},value:function(t){if(null===t||void 0===t)return this.numeric(this.$el.val());t=this.numeric(t);var e=this.validate(t);0!==e&&(t=-1===e?this.min:this.max),this.$el.val(t.toFixed(this.options.precision)),this.oldValue!==this.value()&&(this.$el.trigger("changing.spinner",[this.value(),this.oldValue]),clearTimeout(n),n=setTimeout(i.proxy(function(){this.$el.trigger("changed.spinner",[this.value(),this.oldValue])},this),s.delay))},numeric:function(i){return i=this.options.precision>0?parseFloat(i,10):parseInt(i,10),!isNaN(parseFloat(i))&&isFinite(i)?i:i||this.options.min||0},validate:function(i){return null!==this.options.min&&i<this.min?-1:null!==this.options.max&&i>this.max?1:0}};var s=function(n,s){s=i.extend({},s),this.$el=n,this.$spinning=i("[data-spin='spinner']",this.$el),0===this.$spinning.length&&(this.$spinning=i(":input[type='text']",this.$el)),this.spinning=new t(this.$spinning,i.extend(this.$spinning.data(),s)),this.$el.on("click.spinner","[data-spin='up'],[data-spin='down']",i.proxy(this.spin,this)).on("mousedown.spinner","[data-spin='up'],[data-spin='down']",i.proxy(this.spin,this)),i(document).on("mouseup.spinner",i.proxy(function(){clearTimeout(this.spinTimeout),clearInterval(this.spinInterval)},this)),s.delay&&this.delay(s.delay),s.changed&&this.changed(s.changed),s.changing&&this.changing(s.changing)};s.delay=500,s.prototype={constructor:s,spin:function(n){var t=i(n.currentTarget).data("spin");switch(n.type){case"click":n.preventDefault(),this.spinning.spin(t);break;case"mousedown":1===n.which&&(this.spinTimeout=setTimeout(i.proxy(this.beginSpin,this,t),300))}},delay:function(i){var n=parseInt(i,10);n>=0&&(this.constructor.delay=n+100)},value:function(){return this.spinning.value()},changed:function(i){this.bindHandler("changed.spinner",i)},changing:function(i){this.bindHandler("changing.spinner",i)},bindHandler:function(n,t){i.isFunction(t)?this.$spinning.on(n,t):this.$spinning.off(n)},beginSpin:function(n){this.spinInterval=setInterval(i.proxy(this.spinning.spin,this.spinning,n),100)}},i.fn.spinner=function(n,t){return this.each(function(){var e=i(this),a=e.data("spinner");a||e.data("spinner",a=new s(e,i.extend({},e.data(),n))),("delay"===n||"changed"===n||"changing"===n)&&a[n](t),"step"===n&&t&&(a.spinning.options.step=t),"spin"===n&&t&&a.spinning.spin(t)})},i(function(){i('[data-trigger="spinner"]').spinner()})}(jQuery);